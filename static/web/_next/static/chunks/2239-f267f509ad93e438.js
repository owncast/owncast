(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2239],{8888:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{OwncastPlayer:function(){return OwncastPlayer},default:function(){return OwncastPlayer_OwncastPlayer}});var jsx_runtime=__webpack_require__(85893),react=__webpack_require__(67294),es=__webpack_require__(4480),react_hotkeys_hook_esm=__webpack_require__(49218),video_es=__webpack_require__(85215),VideoJS_module=__webpack_require__(76161),VideoJS_module_default=__webpack_require__.n(VideoJS_module);__webpack_require__(27901);let VideoJS=param=>{let{options,onReady}=param,videoRef=react.useRef(null),playerRef=react.useRef(null);return react.useEffect(()=>{if(!playerRef.current){let videoElement=videoRef.current,player=playerRef.current=(0,video_es.Z)(videoElement,options,()=>(console.debug("player is ready"),onReady&&onReady(player,video_es.Z)));player.autoplay(options.autoplay),player.src(options.sources)}video_es.Z.Vhs.xhr.beforeRequest=o=>{if(o.uri.match("m3u8")){let cachebuster=Math.random().toString(16).substr(2,8);o.uri="".concat(o.uri,"?cachebust=").concat(cachebuster)}return o}},[options,videoRef]),(0,jsx_runtime.jsx)("div",{"data-vjs-player":!0,children:(0,jsx_runtime.jsx)("video",{ref:videoRef,className:"video-js vjs-big-play-centered vjs-show-big-play-button-on-pause ".concat(VideoJS_module_default().player," vjs-owncast")})})},imgStyle={position:"absolute",width:"100%",height:"100%"},CrossfadeImage=param=>{let{src="",width,height,objectFit="fill",duration="1s"}=param,spanStyle=(0,react.useMemo)(()=>({display:"inline-block",position:"relative",width,height}),[width,height]),imgStyles=(0,react.useMemo)(()=>[{...imgStyle,objectFit,opacity:0,transition:"opacity ".concat(duration)},{...imgStyle,objectFit,opacity:1,transition:"opacity ".concat(duration)},{...imgStyle,objectFit,opacity:0}],[objectFit,duration]),[key,setKey]=(0,react.useState)(0),[srcs,setSrcs]=(0,react.useState)(["",""]),nextSrc=src!==srcs[1]?src:"",onLoadImg=()=>{setKey((key+1)%3),setSrcs([srcs[1],nextSrc])};return(0,jsx_runtime.jsx)("span",{style:spanStyle,children:[...srcs,nextSrc].map((singleSrc,index)=>""!==singleSrc&&(0,jsx_runtime.jsx)("img",{src:singleSrc,alt:"",style:imgStyles[index],onLoad:2===index?onLoadImg:void 0},singleSrc))})};CrossfadeImage.defaultProps={objectFit:"fill",duration:"3s"};var VideoPoster_module=__webpack_require__(70034),VideoPoster_module_default=__webpack_require__.n(VideoPoster_module);let VideoPoster=param=>{let timer,{online,initialSrc,src:base}=param,[src,setSrc]=(0,react.useState)(initialSrc),[duration,setDuration]=(0,react.useState)("0s");return(0,react.useEffect)(()=>{clearInterval(timer),timer=setInterval(()=>{"0s"===duration&&setDuration("3s"),setSrc("".concat(base,"?").concat(Date.now()))},2e4)},[]),(0,jsx_runtime.jsxs)("div",{className:VideoPoster_module_default().poster,children:[!online&&(0,jsx_runtime.jsx)("img",{src:initialSrc,alt:"logo"}),online&&(0,jsx_runtime.jsx)(CrossfadeImage,{src:src,duration:duration,objectFit:"cover",width:"100%",height:"100%"})]})};var localStorage=__webpack_require__(72581),ClientConfigStore=__webpack_require__(77466),playback=class{stop(){clearInterval(this.sendMetricsTimer),this.player.off()}setClockSkew(skewMs){this.clockSkewMs=skewMs}videoJSReady(){let tech=this.player.tech({IWillNotUseThisInPlugins:!0});this.supportsDetailedMetrics=!!tech,tech.on("usage",e=>{"vhs-unknown-waiting"===e.name&&this.setIsBuffering(!0),"vhs-rendition-change-abr"===e.name&&this.incrementQualityVariantChanges()});let trackElements=this.player.textTracks();trackElements.addEventListener("cuechange",()=>{this.incrementQualityVariantChanges()})}handlePlaying(){clearInterval(this.collectPlaybackMetricsTimer),this.collectPlaybackMetricsTimer=setInterval(()=>{this.collectPlaybackMetrics()},5e3)}handleEnded(){clearInterval(this.collectPlaybackMetricsTimer)}handleBuffering(){this.incrementErrorCount(1),this.setIsBuffering(!0)}handleNoLongerBuffering(){this.setIsBuffering(!1)}handleError(){this.incrementErrorCount(1)}incrementErrorCount(count){this.errors+=count}incrementQualityVariantChanges(){if(!this.hasPerformedInitialVariantChange){this.hasPerformedInitialVariantChange=!0;return}this.qualityVariantChanges++}setIsBuffering(isBuffering){if(this.isBuffering=isBuffering,!isBuffering){clearTimeout(this.bufferingDurationTimer);return}this.bufferingDurationTimer=setTimeout(()=>{this.incrementErrorCount(1)},500)}trackSegmentDownloadTime(seconds){this.segmentDownloadTime.push(seconds)}trackBandwidth(bps){this.bandwidthTracking.push(bps)}trackLatency(latency){this.latencyTracking.push(latency)}collectPlaybackMetrics(){let tech=this.player.tech({IWillNotUseThisInPlugins:!0});if(!tech||!tech.vhs||this.player.paused())return;let networkState=this.player.networkState();if(2!==networkState)return;let bandwidth=tech.vhs.systemBandwidth;this.trackBandwidth(bandwidth);try{let segment=function(tech){let segment;let targetMedia=tech.vhs.playlists.media(),snapshotTime=tech.currentTime();for(let i=0,l=targetMedia.segments.length;i<l;i++)if(snapshotTime<targetMedia.segments[i].end){segment=targetMedia.segments[i];break}return segment||([segment]=targetMedia.segments),segment}(tech);if(!segment||!segment.dateTimeObject)return;let segmentTime=segment.dateTimeObject.getTime(),now=new Date().getTime()+this.clockSkewMs,latency=now-segmentTime;if(latency<0||latency/1e3>=40)return;this.trackLatency(latency)}catch(err){console.warn(err)}}async send(){let data;if(0===this.segmentDownloadTime.length||!this.player||this.player.paused())return;let errorCount=this.errors;if(this.supportsDetailedMetrics){let average=arr=>arr.reduce((p,c)=>p+c,0)/arr.length,averageDownloadDuration=average(this.segmentDownloadTime)/1e3,averageBandwidth=average(this.bandwidthTracking)/1e3,averageLatency=average(this.latencyTracking)/1e3;data={bandwidth:Math.round(1e3*averageBandwidth)/1e3,latency:Math.round(1e3*averageLatency)/1e3,downloadDuration:Math.round(1e3*averageDownloadDuration)/1e3,errors:errorCount+(this.isBuffering?1:0),qualityVariantChanges:this.qualityVariantChanges}}else data={errors:errorCount+(this.isBuffering?1:0)};this.errors=0,this.qualityVariantChanges=0,this.segmentDownloadTime=[],this.bandwidthTracking=[],this.latencyTracking=[];let options={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(data)};try{await fetch("/api/metrics/playback",options)}catch(e){console.error(e)}}constructor(player,videojs){var _this=this;this.player=player,this.supportsDetailedMetrics=!1,this.hasPerformedInitialVariantChange=!1,this.clockSkewMs=0,this.segmentDownloadTime=[],this.bandwidthTracking=[],this.latencyTracking=[],this.errors=0,this.qualityVariantChanges=0,this.isBuffering=!1,this.bufferingDurationTimer=0,this.collectPlaybackMetricsTimer=0,this.videoJSReady=this.videoJSReady.bind(this),this.handlePlaying=this.handlePlaying.bind(this),this.handleBuffering=this.handleBuffering.bind(this),this.handleEnded=this.handleEnded.bind(this),this.handleError=this.handleError.bind(this),this.send=this.send.bind(this),this.collectPlaybackMetrics=this.collectPlaybackMetrics.bind(this),this.handleNoLongerBuffering=this.handleNoLongerBuffering.bind(this),this.sendMetricsTimer=0,this.player.on("canplaythrough",this.handleNoLongerBuffering),this.player.on("error",this.handleError),this.player.on("stalled",this.handleBuffering),this.player.on("waiting",this.handleBuffering),this.player.on("playing",this.handlePlaying),this.player.on("ended",this.handleEnded);let oldVjsXhrCallback=videojs.xhr;videojs.Vhs.xhr=function(){for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];if(args[0].uri.match(".ts")){let start=new Date,cb=args[1];args[1]=(request,error,response)=>{let end=new Date,delta=end.getTime()-start.getTime();_this.trackSegmentDownloadTime(delta),cb(request,error,response)}}return oldVjsXhrCallback(...args)},this.videoJSReady(),this.sendMetricsTimer=setInterval(()=>{this.send()},1e4)}},settings_menu=function(player,videojs,qualities,latencyItemPressed){let VjsMenuItem=videojs.getComponent("MenuItem"),MenuItem=videojs.getComponent("MenuItem"),MenuButtonClass=videojs.getComponent("MenuButton"),lowLatencyItem=new MenuItem(player,{selectable:!0});lowLatencyItem.setAttribute("class","latency-toggle-item"),lowLatencyItem.on("click",()=>{latencyItemPressed()});let separator=new class extends VjsMenuItem{createEl(){let tag=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"button",props=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},attributes=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},el=super.createEl(tag,props,attributes);return el.innerHTML='<hr style="opacity: 0.3; margin-left: 10px; margin-right: 10px;" />',el}constructor(p,options){super(p,options)}}(player,{selectable:!1});class MenuButton extends MenuButtonClass{createItems(){let tech=player.tech({IWillNotUseThisInPlugins:!0}),defaultAutoItem=new MenuItem(player,{selectable:!0,label:"Auto"}),items=qualities.map(item=>{let newMenuItem=new MenuItem(player,{selectable:!0,label:item.name});return newMenuItem.on("click",()=>{if(!tech){console.warn("Invalid attempt to access null player tech");return}tech.vhs.representations().forEach((rep,index)=>{rep.enabled(index===item.index)}),newMenuItem.selected(!1)}),newMenuItem});defaultAutoItem.on("click",()=>{tech.vhs.representations().forEach(rep=>{rep.enabled(!0)}),defaultAutoItem.selected(!1)});let supportsLatencyCompensator=!!tech&&!!tech.vhs;return qualities.length<2&&supportsLatencyCompensator?[lowLatencyItem]:qualities.length>1&&supportsLatencyCompensator?[defaultAutoItem,...items,separator,lowLatencyItem]:supportsLatencyCompensator||1!==qualities.length?[defaultAutoItem,...items]:[]}constructor(){super(player)}}let tech=player.tech({IWillNotUseThisInPlugins:!0});if(qualities.length<2&&(!tech||!tech.vhs))return;videojs.registerComponent("MenuButton",MenuButton);let menuButton=new MenuButton;return menuButton.addClass("vjs-quality-selector"),menuButton},latencyCompensator=class{setClockSkew(skewMs){this.clockSkewMs=skewMs}check(){if(new Date().getTime()-this.startupTime.getTime()<1e4||this.player.paused()||this.player.seeking()||this.inTimeout||!this.enabled)return;let tech=this.player.tech({IWillNotUseThisInPlugins:!0});if(!tech||!tech.vhs)return;let networkState=this.player.networkState();if(2!==networkState)return;let totalBuffered=0;try{if(0===tech.vhs.stats.buffered.length){this.timeout();return}tech.vhs.stats.buffered.forEach(buffer=>{totalBuffered+=buffer.end-buffer.start})}catch(e){console.error(e)}let currentPlaylist=tech.vhs.playlists.media(),currentPlaylistBandwidth=currentPlaylist.attributes.BANDWIDTH,playerBandwidth=tech.vhs.systemBandwidth,bandwidthRatio=playerBandwidth/currentPlaylistBandwidth;try{let segment=function(tech){let segment;let targetMedia=tech.vhs.playlists.media(),snapshotTime=tech.currentTime();for(let i=0,l=targetMedia.segments.length;i<l;i++)if(snapshotTime<targetMedia.segments[i].end){segment=targetMedia.segments[i];break}return segment||([segment]=targetMedia.segments),segment}(tech);if(!segment)return;if(bandwidthRatio<1.8&&totalBuffered<6*segment.duration){this.timeout();return}let computedMinLatencyThreshold=Math.max(4e3,1e3*segment.duration*1.8),targetLatencies=this.bufferedAtLatency.concat([computedMinLatencyThreshold]),minLatencyThreshold=targetLatencies.reduce((sum,current)=>sum+current,0)/targetLatencies.length,maxLatencyThreshold=Math.max(1.4*minLatencyThreshold,Math.min(1e3*segment.duration*2.6,15e3));minLatencyThreshold>=maxLatencyThreshold&&(maxLatencyThreshold=minLatencyThreshold+3e3);let segmentTime=segment.dateTimeObject.getTime(),now=new Date().getTime()+this.clockSkewMs,latency=now-segmentTime;if(this.currentLatency=latency,Math.abs(latency)>8e4){this.timeout();return}if(latency>maxLatencyThreshold){if(this.shouldJumpToLive()&&latency>maxLatencyThreshold+5e3){let jumpAmount=latency/1e3-3*segment.duration,seekPosition=this.player.currentTime()+jumpAmount;console.info("latency",latency/1e3,"jumping",jumpAmount,"to live from ",this.player.currentTime()," to ",seekPosition);let availableBufferedTimeEnd=tech.vhs.stats.buffered[0].end,availableBufferedTimeStart=tech.vhs.stats.buffered[0].start;if(seekPosition>availableBufferedTimeStart<availableBufferedTimeEnd){this.jump(seekPosition);return}}let proposedPlaybackRate=.33*bandwidthRatio;(proposedPlaybackRate=Math.max(Math.min(proposedPlaybackRate,1.08),1))>this.playbackRate+.02&&(proposedPlaybackRate=this.playbackRate+.02),proposedPlaybackRate=Math.round(1e3*proposedPlaybackRate)/1e3,this.start(proposedPlaybackRate)}else latency<=minLatencyThreshold&&this.stop();console.info("latency",latency/1e3,"min",minLatencyThreshold/1e3,"max",maxLatencyThreshold/1e3,"playback rate",this.playbackRate,"enabled:",this.enabled,"running: ",this.running,"skew: ",this.clockSkewMs,"rebuffer events: ",this.bufferingCounter)}catch(err){}}shouldJumpToLive(){if(this.bufferingCounter>1)return!1;let now=new Date().getTime(),delta=now-this.lastJumpOccurred;return delta>2e4}jump(seekPosition){this.jumpingToLiveIgnoreBuffer=!0,this.performedInitialLiveJump=!0,this.lastJumpOccurred=new Date,console.info("current time",this.player.currentTime(),"seeking to",seekPosition),this.player.currentTime(seekPosition),setTimeout(()=>{this.jumpingToLiveIgnoreBuffer=!1},5e3)}setPlaybackRate(rate){this.playbackRate=rate,this.player.playbackRate(rate)}start(){let rate=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;!this.inTimeout&&this.enabled&&rate!==this.playbackRate&&(this.running=!0,this.setPlaybackRate(rate))}stop(){this.running&&console.log("stopping latency compensator..."),this.running=!1,this.setPlaybackRate(1)}enable(){this.enabled=!0,clearInterval(this.checkTimer),clearTimeout(this.bufferingTimer),this.checkTimer=setInterval(()=>{this.check()},3e3)}disable(){clearInterval(this.checkTimer),clearTimeout(this.timeoutTimer),this.stop(),this.enabled=!1}timeout(){this.jumpingToLiveIgnoreBuffer||(this.inTimeout=!0,this.stop(),clearTimeout(this.timeoutTimer),this.timeoutTimer=setTimeout(()=>{this.endTimeout()},3e4))}endTimeout(){clearTimeout(this.timeoutTimer),this.inTimeout=!1}handlePlaying(){let wasPreviouslyPlaying=this.playing;this.playing=!0,clearTimeout(this.bufferingTimer),this.enabled&&this.shouldJumpToLive()&&(wasPreviouslyPlaying||(this.jumpingToLiveIgnoreBuffer=!0,this.player.liveTracker.seekToLiveEdge(),this.lastJumpOccurred=new Date))}handlePause(){this.playing=!1}handleEnded(){this.enabled&&this.disable()}handleError(){this.enabled&&this.timeout()}countBufferingEvent(){if(this.bufferingCounter+=1,this.bufferingCounter>4){this.disable();return}this.bufferedAtLatency.push(this.currentLatency),console.log("latency compensation timeout due to buffering:",this.bufferingCounter,"buffering events of",4),setTimeout(()=>{this.bufferingCounter>0&&(this.bufferingCounter-=1)},18e4)}handleBuffering(){if(this.enabled&&!this.inTimeout){if(this.jumpingToLiveIgnoreBuffer){this.jumpingToLiveIgnoreBuffer=!1;return}this.timeout(),clearTimeout(this.bufferingTimer),this.bufferingTimer=setTimeout(()=>{this.countBufferingEvent()},200)}}constructor(player){this.player=player,this.playing=!1,this.enabled=!1,this.running=!1,this.inTimeout=!1,this.jumpingToLiveIgnoreBuffer=!1,this.timeoutTimer=0,this.checkTimer=0,this.bufferingCounter=0,this.bufferingTimer=0,this.playbackRate=1,this.lastJumpOccurred=null,this.startupTime=new Date,this.clockSkewMs=0,this.currentLatency=null,this.bufferedAtLatency=[],this.player.on("playing",this.handlePlaying.bind(this)),this.player.on("pause",this.handlePause.bind(this)),this.player.on("error",this.handleError.bind(this)),this.player.on("waiting",this.handleBuffering.bind(this)),this.player.on("stalled",this.handleBuffering.bind(this)),this.player.on("ended",this.handleEnded.bind(this)),this.player.on("canplaythrough",this.handlePlaying.bind(this)),this.player.on("canplay",this.handlePlaying.bind(this)),this.check=this.check.bind(this),this.start=this.start.bind(this),this.enable=this.enable.bind(this),this.countBufferingEvent=this.countBufferingEvent.bind(this)}},OwncastPlayer_module=__webpack_require__(83360),OwncastPlayer_module_default=__webpack_require__.n(OwncastPlayer_module);let PLAYER_VOLUME="owncast_volume",LATENCY_COMPENSATION_ENABLED="latencyCompensatorEnabled",OwncastPlayer_ping=new class{start(){this.stop(),this.timer=setInterval(()=>{!function(){try{fetch("/api/ping")}catch(e){console.error(e)}}()},4e3)}stop(){clearInterval(this.timer)}},playbackMetrics=null,OwncastPlayer_latencyCompensator=null,latencyCompensatorEnabled=!1;async function getVideoSettings(){let qualities=[];try{let response=await fetch("/api/video/variants");qualities=await response.json()}catch(e){console.error(e)}return qualities}let OwncastPlayer=param=>{let{source,online}=param,playerRef=react.useRef(null),[videoPlaying,setVideoPlaying]=(0,es.FV)(ClientConfigStore.We),clockSkew=(0,es.sJ)(ClientConfigStore.g8),setSavedVolume=()=>{try{playerRef.current.volume((0,localStorage.$o)(PLAYER_VOLUME)||1)}catch(err){console.warn(err)}},handleVolume=()=>{(0,localStorage.qQ)(PLAYER_VOLUME,playerRef.current.muted()?0:playerRef.current.volume())},togglePlayback=()=>{playerRef.current.paused()?playerRef.current.play():playerRef.current.pause()},toggleMute=()=>{playerRef.current.muted()||0===playerRef.current.volume()?playerRef.current.volume(.7):playerRef.current.volume(0)},toggleFullScreen=()=>{playerRef.current.isFullscreen()?playerRef.current.exitFullscreen():playerRef.current.requestFullscreen()},setLatencyCompensatorItemTitle=title=>{let item=document.querySelector(".latency-toggle-item > .vjs-menu-item-text");item&&(item.innerHTML=title)},startLatencyCompensator=()=>{OwncastPlayer_latencyCompensator&&OwncastPlayer_latencyCompensator.stop(),latencyCompensatorEnabled=!0,(OwncastPlayer_latencyCompensator=new latencyCompensator(playerRef.current)).setClockSkew(clockSkew),OwncastPlayer_latencyCompensator.enable(),(0,localStorage.qQ)(LATENCY_COMPENSATION_ENABLED,!0),setLatencyCompensatorItemTitle("disable minimized latency")},stopLatencyCompensator=()=>{OwncastPlayer_latencyCompensator&&OwncastPlayer_latencyCompensator.disable(),OwncastPlayer_latencyCompensator=null,latencyCompensatorEnabled=!1,(0,localStorage.qQ)(LATENCY_COMPENSATION_ENABLED,!1),setLatencyCompensatorItemTitle('<span style="font-size: 0.8em">enable minimized latency (experimental)</span>')},toggleLatencyCompensator=()=>{latencyCompensatorEnabled?stopLatencyCompensator():startLatencyCompensator()},setupLatencyCompensator=player=>{let tech=player.tech({IWillNotUseThisInPlugins:!0});if(!tech||!tech.vhs)return;let latencyCompensatorEnabledSaved=(0,localStorage.$o)(LATENCY_COMPENSATION_ENABLED);"true"===latencyCompensatorEnabledSaved&&tech&&tech.vhs?startLatencyCompensator():stopLatencyCompensator()},createSettings=async(player,videojs)=>{let videoQualities=await getVideoSettings(),menuButton=settings_menu(player,videojs,videoQualities,toggleLatencyCompensator);player.controlBar.addChild(menuButton,{},player.controlBar.children_.length-2),setupLatencyCompensator(player)},setupAirplay=(player,videojs)=>{if(window.hasOwnProperty("WebKitPlaybackTargetAvailabilityEvent")){let videoJsButtonClass=videojs.getComponent("Button"),ConcreteButtonClass=videojs.extend(videoJsButtonClass,{constructor(){videoJsButtonClass.call(this,player)},handleClick(){try{let videoElement=document.getElementsByTagName("video")[0];videoElement.webkitShowPlaybackTargetPicker()}catch(e){console.error(e)}}}),concreteButtonInstance=player.controlBar.addChild(new ConcreteButtonClass);concreteButtonInstance.addClass("vjs-airplay")}};(0,react_hotkeys_hook_esm.y1)("space",e=>{e.preventDefault(),togglePlayback()}),(0,react_hotkeys_hook_esm.y1)("f",toggleFullScreen,{enableOnContentEditable:!1}),(0,react_hotkeys_hook_esm.y1)("m",toggleMute,{enableOnContentEditable:!1}),(0,react_hotkeys_hook_esm.y1)("0",()=>playerRef.current.volume(playerRef.current.volume()+.1),{enableOnContentEditable:!1}),(0,react_hotkeys_hook_esm.y1)("9",()=>playerRef.current.volume(playerRef.current.volume()-.1),{enableOnContentEditable:!1});let handlePlayerReady=(player,videojs)=>{playerRef.current=player,setSavedVolume(),setupAirplay(player,videojs),player.on("waiting",()=>{console.debug("player is waiting")}),player.on("dispose",()=>{console.debug("player will dispose"),OwncastPlayer_ping.stop()}),player.on("playing",()=>{console.debug("player is playing"),OwncastPlayer_ping.start(),setVideoPlaying(!0)}),player.on("pause",()=>{console.debug("player is paused"),OwncastPlayer_ping.stop(),setVideoPlaying(!1)}),player.on("ended",()=>{console.debug("player is ended"),OwncastPlayer_ping.stop(),setVideoPlaying(!1)}),videojs.hookOnce(),player.on("volumechange",handleVolume),(playbackMetrics=new playback(player,videojs)).setClockSkew(clockSkew),createSettings(player,videojs)};return(0,react.useEffect)(()=>{playbackMetrics&&playbackMetrics.setClockSkew(clockSkew)},[clockSkew]),(0,react.useEffect)(()=>()=>{stopLatencyCompensator(),null==playbackMetrics||playbackMetrics.stop()},[]),(0,jsx_runtime.jsxs)("div",{className:OwncastPlayer_module_default().container,children:[online&&(0,jsx_runtime.jsx)("div",{className:OwncastPlayer_module_default().player,children:(0,jsx_runtime.jsx)(VideoJS,{options:{autoplay:!1,controls:!0,responsive:!0,fluid:!1,playsinline:!0,liveui:!0,preload:"auto",controlBar:{progressControl:{seekBar:!1}},html5:{vhs:{enableLowInitialPlaylist:!0,experimentalBufferBasedABR:!0,useNetworkInformationApi:!0,maxPlaylistRetries:30}},liveTracker:{trackingThreshold:0,liveTolerance:15},sources:[{src:source,type:"application/x-mpegURL"}]},onReady:handlePlayerReady})}),(0,jsx_runtime.jsx)("div",{className:OwncastPlayer_module_default().poster,children:!videoPlaying&&(0,jsx_runtime.jsx)(VideoPoster,{online:online,initialSrc:"/thumbnail.jpg",src:"/thumbnail.jpg"})})]})};var OwncastPlayer_OwncastPlayer=OwncastPlayer},83360:function(module){module.exports={container:"OwncastPlayer_container__YfgRy",player:"OwncastPlayer_player__R7XKJ",poster:"OwncastPlayer_poster__8RqUC"}},76161:function(module){module.exports={player:"VideoJS_player__GT8FN"}},70034:function(module){module.exports={poster:"VideoPoster_poster__RDkSk"}},25893:function(){}}]);